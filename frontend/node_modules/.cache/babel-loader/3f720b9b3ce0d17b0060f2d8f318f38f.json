{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\S\\\\Documents\\\\Proyecto-Backend-1\\\\frontend\\\\src\\\\pages\\\\Post\\\\Page.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nimport \"./style.scss\";\nimport { useSelector } from \"react-redux\";\nimport { getUrl } from \"../../services/apiSlice\";\nimport { addToCart, fetchPost, fetchReviews, fetchUser } from \"../../services/api\";\nimport { Spinner } from \"../../components/spinners\";\nimport { useNavigate, useParams } from \"react-router\";\nimport { RegularPrimaryButton } from \"../../components/buttons\";\nimport { Review } from \"../../components/review\";\nimport { getUser } from \"../../services/userSlice\";\nimport { NewReview } from \"../../components/new-review\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Page = () => {\n  _s();\n\n  const navigate = useNavigate();\n  const [productData, setProductData] = React.useState(undefined);\n  const [ownerData, setOwnerData] = React.useState(undefined);\n  const [reviewData, setReviewData] = React.useState(undefined);\n  const [reqState, setReqState] = React.useState(undefined);\n  const API_URL = useSelector(getUrl);\n  const params = useParams();\n  const userData = useSelector(getUser);\n\n  const fetch = async () => {\n    const product = await fetchPost({\n      url: API_URL,\n      params: {\n        post_id: params.id\n      }\n    });\n    setProductData(product);\n    const owner = await fetchUser({\n      url: API_URL,\n      params: {\n        user_id: product.owner_id\n      }\n    });\n    setOwnerData(owner);\n    const reviews = await fetchReviews({\n      url: API_URL,\n      params: {\n        product_id: params.id\n      }\n    });\n    setReviewData(reviews);\n  };\n\n  React.useEffect(() => {\n    fetch();\n  }, []);\n\n  if (!productData) {\n    return /*#__PURE__*/_jsxDEV(Spinner, {\n      text: 'Loading...'\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 16\n    }, this);\n  }\n\n  const refreshData = async () => await fetch();\n\n  const redirectSeller = () => navigate(`/profile/${productData.owner_id}`);\n\n  const handleBuy = async () => {\n    if (!userData) {\n      navigate('/login');\n    } else {\n      await addToCart({\n        url: API_URL,\n        params: {\n          user_id: userData._id,\n          product_id: params.id\n        }\n      });\n      setReqState(true);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"page post\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: productData.display_name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n      className: 'post__img',\n      src: productData.img_url\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'post__price',\n      children: `$${productData.price}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this), ownerData && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'post__seller',\n      onClick: redirectSeller,\n      children: `Seller: ${ownerData.display_name}`\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 26\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'post__timestamp small-text',\n      children: productData.created_date\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(RegularPrimaryButton, {\n      stateColor: reqState,\n      onClick: handleBuy,\n      children: reqState ? \"Added to cart\" : \"Add to cart\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Reviews\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: 'post__reviews',\n      children: [reviewData ? reviewData.length > 0 ? reviewData.map((item, key) => /*#__PURE__*/_jsxDEV(Review, {\n        showAuthor: true,\n        showProduct: false,\n        data: item\n      }, key, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 55\n      }, this)) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'post__no-reviews',\n        children: \" No reviews. \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(Spinner, {\n        text: \"Loading reviews...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(NewReview, {\n        product_id: params.id,\n        refreshReviews: refreshData\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 12\n  }, this);\n};\n\n_s(Page, \"QLXiU6yw7nPm5O8l+FV9M0uFPdw=\", false, function () {\n  return [useNavigate, useSelector, useParams, useSelector];\n});\n\n_c = Page;\nexport default Page;\n\nvar _c;\n\n$RefreshReg$(_c, \"Page\");","map":{"version":3,"sources":["C:/Users/S/Documents/Proyecto-Backend-1/frontend/src/pages/Post/Page.js"],"names":["React","useSelector","getUrl","addToCart","fetchPost","fetchReviews","fetchUser","Spinner","useNavigate","useParams","RegularPrimaryButton","Review","getUser","NewReview","Page","navigate","productData","setProductData","useState","undefined","ownerData","setOwnerData","reviewData","setReviewData","reqState","setReqState","API_URL","params","userData","fetch","product","url","post_id","id","owner","user_id","owner_id","reviews","product_id","useEffect","refreshData","redirectSeller","handleBuy","_id","display_name","img_url","price","created_date","length","map","item","key"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./style.scss\"\r\nimport {useSelector} from \"react-redux\";\r\nimport {getUrl} from \"../../services/apiSlice\";\r\nimport {addToCart, fetchPost, fetchReviews, fetchUser} from \"../../services/api\";\r\nimport {Spinner} from \"../../components/spinners\";\r\nimport {useNavigate, useParams} from \"react-router\";\r\nimport {RegularPrimaryButton} from \"../../components/buttons\";\r\nimport {Review} from \"../../components/review\";\r\nimport {getUser} from \"../../services/userSlice\";\r\nimport {NewReview} from \"../../components/new-review\";\r\n\r\nconst Page = () => {\r\n    const navigate = useNavigate()\r\n    const [productData, setProductData] = React.useState(undefined)\r\n    const [ownerData, setOwnerData] = React.useState(undefined)\r\n    const [reviewData, setReviewData] = React.useState(undefined)\r\n    const [reqState, setReqState] = React.useState(undefined)\r\n    const API_URL = useSelector(getUrl)\r\n    const params = useParams();\r\n    const userData = useSelector(getUser);\r\n\r\n    const fetch = async () => {\r\n        const product = await fetchPost({url: API_URL, params: {post_id: params.id}})\r\n        setProductData(product)\r\n\r\n        const owner = await fetchUser({url: API_URL, params: {user_id: product.owner_id}})\r\n        setOwnerData(owner)\r\n\r\n        const reviews = await fetchReviews({url: API_URL, params: {product_id: params.id}})\r\n        setReviewData(reviews)\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        fetch()\r\n    }, [])\r\n\r\n    if (!productData) {\r\n        return <Spinner text={'Loading...'}/>\r\n    }\r\n    const refreshData = async () => await fetch()\r\n    const redirectSeller = () => navigate(`/profile/${productData.owner_id}`)\r\n    const handleBuy = async () => {\r\n        if (!userData) {\r\n            navigate('/login')\r\n        } else {\r\n            await addToCart({url: API_URL, params: {user_id: userData._id, product_id: params.id}})\r\n            setReqState(true)\r\n        }\r\n    }\r\n\r\n    return <div className={\"page post\"}>\r\n        <h1>\r\n            {productData.display_name}\r\n        </h1>\r\n        <img\r\n            className={'post__img'}\r\n            src={productData.img_url}\r\n        />\r\n        <div className={'post__price'}>\r\n            {`$${productData.price}`}\r\n        </div>\r\n        {\r\n            ownerData && <div className={'post__seller'} onClick={redirectSeller}>\r\n                {`Seller: ${ownerData.display_name}`}\r\n            </div>\r\n        }\r\n        <div className={'post__timestamp small-text'}>\r\n            {productData.created_date}\r\n        </div>\r\n        <RegularPrimaryButton stateColor={reqState} onClick={handleBuy}>\r\n            {reqState ? \"Added to cart\" : \"Add to cart\"}\r\n        </RegularPrimaryButton>\r\n        <h2>\r\n            Reviews\r\n        </h2>\r\n        <div className={'post__reviews'}>\r\n            {\r\n                reviewData ?\r\n                    reviewData.length > 0 ?\r\n                        reviewData.map((item, key) => <Review\r\n                            showAuthor={true}\r\n                            showProduct={false}\r\n                            key={key}\r\n                            data={item}\r\n                        />)\r\n                        :\r\n                        <div className={'post__no-reviews'}> No reviews. </div>\r\n                    :\r\n                    <Spinner\r\n                        text={\"Loading reviews...\"}\r\n                    />\r\n            }\r\n            <NewReview\r\n                product_id={params.id}\r\n                refreshReviews={refreshData}\r\n            />\r\n        </div>\r\n    </div>\r\n}\r\n\r\nexport default Page"]},"metadata":{},"sourceType":"module"}